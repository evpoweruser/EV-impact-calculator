<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>EV Emissions Calculator</title>
    <style>
        /* ... (keep previous styles) ... */
        select { padding: 8px; margin: 0.5rem 0; width: 200px; }
        .energy-mix { margin: 0.5rem 0; font-size: 0.9em; color: #666; }
    </style>
</head>
<body>
    <div class="card">
        <h2>EV Emissions Calculator</h2>
        <div>
            <input type="number" id="kmInput" placeholder="Enter kilometers" value="100">
            <select id="countrySelect">
                <option value="global">Global Average</option>
                <option value="NO">Norway</option>
                <option value="FR">France</option>
                <option value="DE">Germany</option>
                <option value="US">United States</option>
                <option value="CN">China</option>
                <option value="IN">India</option>
            </select>
            <button onclick="calculate()">Calculate</button>
        </div>

        <div id="results" style="display: none;">
            <div class="energy-mix" id="energyMix"></div>
            <div class="result">
                <h3 class="co2-ev" id="evOutput"></h3>
                <p>VS Diesel: <span class="co2-diesel" id="dieselOutput"></span></p>
                <p>VS Petrol: <span class="co2-petrol" id="petrolOutput"></span></p>
            </div>
        </div>
    </div>

    <script>
        // Data from Our World in Data (simplified for demo)
        const COUNTRY_DATA = {
            'global': { fossil: 60, renewable: 30, nuclear: 10 },
            'NO': { fossil: 2, renewable: 98, nuclear: 0 },   // Norway
            'FR': { fossil: 8, renewable: 23, nuclear: 69 },  // France
            'DE': { fossil: 44, renewable: 44, nuclear: 12 }, // Germany
            'US': { fossil: 60, renewable: 21, nuclear: 19 }, // USA
            'CN': { fossil: 65, renewable: 30, nuclear: 5 },  // China
            'IN': { fossil: 75, renewable: 23, nuclear: 2 }   // India
        };

        const FOSSIL_CO2_KG_PER_KWH = 0.475; // Average for fossil electricity
        const RENEWABLE_CO2_KG_PER_KWH = 0.05; // Includes manufacturing impacts

        function calculate() {
            const km = parseFloat(document.getElementById('kmInput').value);
            const country = document.getElementById('countrySelect').value;
            const data = COUNTRY_DATA[country];
            
            // Calculate national electricity mix CO2 intensity
            const electricityCo2 = (
                (data.fossil * FOSSIL_CO2_KG_PER_KWH) +
                (data.renewable * RENEWABLE_CO2_KG_PER_KWH)
            ) / 100;

            // EV calculations
            const evKwh = km * 0.18; // 0.18 kWh/km
            const evCo2 = evKwh * electricityCo2;

            // ICE calculations (unchanged)
            const dieselCo2 = (km / 14) * 2.64;
            const petrolCo2 = (km / 12) * 2.31;

            // Update display
            document.getElementById('energyMix').innerHTML = `
                ${data.renewable}% renewable âš¡ 
                ${data.fossil}% fossil ðŸ”¥ 
                (CO2 intensity: ${electricityCo2.toFixed(3)}kg/kWh)
            `;

            document.getElementById('evOutput').textContent = 
                `${evKwh.toFixed(1)}kWh (${evCo2.toFixed(1)}kg COâ‚‚)`;
            
            document.getElementById('dieselOutput').textContent = 
                `${dieselCo2.toFixed(1)}kg (Save ${(dieselCo2 - evCo2).toFixed(1)}kg)`;
            
            document.getElementById('petrolOutput').textContent = 
                `${petrolCo2.toFixed(1)}kg (Save ${(petrolCo2 - evCo2).toFixed(1)}kg)`;
            
            document.getElementById('results').style.display = 'block';
        }
    </script>
</body>
</html>
